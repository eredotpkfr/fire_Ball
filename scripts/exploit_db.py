#!/usr/bin/env python3
#-*-coding:utf-8-*-

import requests
from bs4 import BeautifulSoup
import time
def exploit_db():
    try:
        pageNumber = int(input('\033[94m'+"[+] How Many Pages To Visit:\n>> "+'\033[0m'))
        PATH = input('\033[94m'+"[+] Please Insert Any Path Results Are Write This Path With TXT File:\n>> "+'\033[0m')
        file = open(PATH+'/Results.txt','w')
    except Exception:
        print('\033[91m'+"[!] An Unexpected Error Was Encountered !"+'\033[0m')
        time.sleep(0.5)
        print('\033[91m'+"[!] Path Is Not Found Please Check It !"+'\033[0m')
        time.sleep(0.7)
        print('\033[93m'+"[+] Returning to the options..."+'\033[0m')
        time.sleep(0.7)
        fire_Ball.function_Options()
    try:
        for x in range(1,pageNumber + 1):
            try:
                r = requests.get('https://www.exploit-db.com/browse/?order_by=date_published&order=desc&pg=' + str(pageNumber),headers = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36'})
                soup = BeautifulSoup(r.content,'lxml')
            except Exception:
                print('\033[91m'+"[!] An Unexpected Error Was Encountered !"+'\033[0m')
                time.sleep(0.5)
                print('\033[91m'+"[!] Request Not Send !"+'\033[0m')
                time.sleep(0.5)
                print('\033[93m'+"[+] Returning to the options..."+'\033[0m')
                time.sleep(0.7)
                fire_Ball.function_Options()
            tables = soup.find('table',attrs={'class':'exploit_list bootstrap-wrapper'}).tbody.find_all('tr')
            for trs in tables:
                description = trs.find('td',attrs = {'class':'description'}).a.text.strip()
                date = trs.find('td',attrs = {'class':'date'}).text.strip()
                dl = trs.find('td',attrs = {'class':'dlink'}).a.get('href')
                platform = trs.find('td',attrs = {'class':'platform'}).a.text.strip()
                author = trs.find('td',attrs = {'class':'author'}).a.get('title').strip()
                file.write('Description : '+description+'\n')
                file.write('Date : '+date+'\n')
                file.write('Platform : '+platform+'\n')
                file.write('Author : '+author+'\n')
                file.write('Download Link : '+dl+'\n')
                file.write('-'*75+'\n')
                print('\033[94m'+'Description : {}\nDate : {}\nPlatform : {}\nAuthor : {}\nDownload Link :{}'.format(description,date,platform,author,' ["'+dl+'"]')+'\033[0m')
                print('\033[93m'+'-'*75+'\033[0m')
                time.sleep(0.2)
            print('\033[92m'+"[+] Operation completed successfully..."+'\033[0m')
            time.sleep(0.7)
            print('\033[93m'+"[+] Returning to the options..."+'\033[0m')
            time.sleep(0.7)
            fire_Ball.function_Options()
            time.sleep(0.5)
            file.close()
    except Exception:
        print('\033[91m'+"[!] An Unexpected Error Was Encountered !"+'\033[0m')
        time.sleep(0.7)
        print('\033[93m'+"[+] Returning to the options..."+'\033[0m')
        time.sleep(0.7)
        fire_Ball.function_Options()

        

